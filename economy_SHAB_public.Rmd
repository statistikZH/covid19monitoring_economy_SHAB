---
title: "Eröffnungen von Konkursverfahren"
knit: (function(input_file, encoding) {
  out_dir <- 'docs';
  rmarkdown::render(input_file,
 encoding=encoding,
 output_file=file.path(dirname(input_file), out_dir, 'index.html'))})
output: 
  html_document:
    toc: true
    toc_depth: 3
    toc_float:
      collapsed: true
      smooth_scroll: true
    theme: lumen
    highlight: tango
---

<style type="text/css">
.main-container {
  max-width: 1800px;
  margin-left: 0;
  margin-right: auto;
}
blockquote {
    padding: 10px 20px;
    margin: 0 0 20px;
    font-size: 14px;
    border-left: 5px solid #eee;
}

h1.title {
  font-size: 38px;
  color: #000000;
  }
  
h1 { /* Header 1 */
  font-size: 28px;
  color: #0033cc;
}
h2 { /* Header 2 */
    font-size: 18px;
	color: #0099ff
}
h3 { /* Header 3 */
    font-size: 14px;
	color: #6600cc
}
</style>

![](logo/KtZuerichLogo.png)


# Diese Seite dient Testzwecken. 
<span style="color: red;">Diese Seite dient Testzwecken. Die Daten sind nicht überprüft.</span>


**Auf dieser Seite finden Sie Information zu den eröffneten Konkursverfahren gegen Firmen. Die Auswertung basiert auf den publizierten Meldungen im Schweizerischen Amtshandelsblatt (SHAB). Verfahren aufgrund organisatorischer Mängel werden nicht berücksichtigt.**<br><br>



```{r Vorbereitungen,echo = F,collapse=TRUE, warning=FALSE,  message=FALSE}
rm(list=ls())
options(stringsAsFactors = F)

### Packages 
library(dplyr)
library(ggplot2)
library(scales)
library(plotly)

```

```{r Daten laden und aufbreiten,echo = F,collapse=TRUE, warning=FALSE,  message=FALSE}
rolling_mean_7 <- tibbletime::rollify(mean, window = 7)
rolling_mean_5 <- tibbletime::rollify(mean, window = 5)
lastmon <- function(x) 7 * floor(as.numeric(x-1+4)/7) + as.Date(1-4, origin="1970-01-01")

dba <- read.csv('Economy_SHAB.csv')

dba$date <- as.Date(dba$date)
dba$monday <- lastmon(dba$date)
dba$week <- lubridate::isoweek(dba$date)
```

# Schweiz
<span style="color: red;">Diese Seite dient Testzwecken. Die Daten sind nicht überprüft.</span>

## Kumulierte Werte
Die Grafik ermöglicht einen Vergleich der gesamtscheizerische Entwicklung in den Jahren 2019 und 2020. Dargestellt ist die kumulierte Anzahl der Konkurseröffnungen.

```{r Plot Schweiz kumuliert,echo = F,collapse=TRUE, warning=FALSE,  message=FALSE}
pldf_cum <- dba%>%
  group_by(date)%>%
  summarise(chsum = sum(value))%>%
  ungroup()%>%
  mutate(year = substring(date,1,4))%>%
  group_by(year)%>%
  mutate(cum_chsum = cumsum(chsum))%>%
  ungroup()%>%
  mutate(rollmean = round(rolling_mean_5(chsum),2))%>%
  mutate(week = lubridate::isoweek(date))%>%
  mutate(day_date = format(date, format="%m-%d"))%>%
  mutate(day_date = as.Date(day_date,format="%m-%d"))%>%
  mutate(monday = lastmon(date))%>%
  filter(year>= 2019)

p_ch_cum <- ggplot(pldf_cum,aes(day_date,cum_chsum,col=year,group=year)) +
  geom_path(aes(text=sprintf("Tag: %s<br>Kumulierte Tageswerte: %s<br>Tageswert: %s", day_date,cum_chsum,chsum)))+
      scale_color_manual(values = c('2019'='#EDDD79',
                                    '2020'='#F3A5A7')) +
  scale_x_date(labels = date_format("%d.%m"))+
 labs(y = 'Kumulierte Tageswerte<br><br> ', 
     x = ' <br>Datum', 
     title = "", 
     subtitle = "",
     caption = paste0('Daten: SHAB via Moneyhouse API / Gesellschaftsmonitoring COVID-19 STAT'))+
  theme_bw()+
  theme(
        legend.title = element_blank())
      
      
gg_cum <- ggplotly(p_ch_cum, tooltip="text",height=400) %>%  
  plotly::config(displayModeBar = F)%>%
   layout(
          margin = list(l = 75),
          xaxis=list(fixedrange=TRUE),
          yaxis=list(fixedrange=TRUE),
          autosize=T)

gg_cum <- plotly_build(gg_cum)

gg_cum


```


## Rollender Mittelwert
Die Grafik ermöglicht einen Vergleich der gesamtscheizerische Entwicklung in den Jahren 2019 und 2020. Dargestellt sind die rollenden Mittelwerte über die fünf letzten Werktage.

```{r Plot Schweiz,echo = F,collapse=TRUE, warning=FALSE,  message=FALSE}
pldf <- dba%>%
  group_by(date)%>%
  summarise(chsum = sum(value))%>%
  ungroup()%>%
  mutate(rollmean = round(rolling_mean_5(chsum),2))%>%
  mutate(year = substring(date,1,4))%>%
  mutate(week = lubridate::isoweek(date))%>%
  mutate(day_date = format(date, format="%m-%d"))%>%
  mutate(day_date = as.Date(day_date,format="%m-%d"))%>%
  mutate(monday = lastmon(date))%>%
  filter(year>= 2019)

p_ch <- ggplot(pldf,aes(day_date,rollmean,col=year,group=year)) +
  geom_path(aes(text=sprintf("Tag: %s<br>5-Tage-Mittelwert: %s<br>Tageswert: %s", day_date,rollmean,chsum)))+
      scale_color_manual(values = c('2019'='#EDDD79',
                                    '2020'='#F3A5A7')) +
  scale_x_date(labels = date_format("%d.%m"))+
 labs(y = 'Rollender Mittelwert<br> ', 
     x = ' <br>Datum', 
     title = "", 
     subtitle = "",
     caption = paste0('Daten: SHAB via Moneyhouse API / Gesellschaftsmonitoring COVID-19 STAT'))+
  theme_bw()+
  theme(
        legend.title = element_blank())
      
      
gg <- ggplotly(p_ch, tooltip="text") %>%  
  plotly::config(displayModeBar = F)%>%
   layout(
          margin = list(l = 75),
          xaxis=list(fixedrange=TRUE),
          yaxis=list(fixedrange=TRUE),
          autosize=T)

gg <- plotly_build(gg)

gg


```

# Kantone
<span style="color: red;">Diese Seite dient Testzwecken. Die Daten sind nicht überprüft.</span>

## Kumulierte Werte
Die Grafik ermöglicht einen Vergleich der Entwicklungen in den Kantonen in den Jahren 2019 und 2020. Dargestellt sind kumulierten Werte.  

```{r Plot Kantone kumuliert,echo = F,collapse=TRUE, warning=FALSE,  message=FALSE}
pldf_cant_cum <- dba%>%
  mutate(year = substring(date,1,4))%>%
  mutate(week = lubridate::isoweek(date))%>%
  group_by(location, year)%>%
  mutate(cum_cant = cumsum(value))%>%
  ungroup()%>%
  mutate(week = lubridate::isoweek(date))%>%
  mutate(day_date = format(date, format="%m-%d"))%>%
  mutate(day_date = as.Date(day_date,format="%m-%d"))%>%
  mutate(monday = lastmon(date))%>%
  filter(year>=2019)


p_cant_cum <- ggplot(pldf_cant_cum,aes(day_date,cum_cant)) +
geom_path(aes(col=year, group=year,
              text=sprintf("Datum: %s<br>Kumulierter Wert: %s<br>Tageswert: %s", day_date,cum_cant,value)))+
  scale_color_manual(values = c('2019'='#EDDD79',
                                    '2020'='#F3A5A7')) +
  scale_x_date(labels = date_format("%d.%m"), breaks = as.Date(c('01.03','01.06','01.09','01.12'),format="%d.%m"))+
  facet_wrap(~ location,ncol=3)+
 labs(y = 'Kumulierte Werte<br> ', 
     x = ' <br>Datum', 
     title = "", 
     subtitle = "",
     caption = paste0('Daten: SHAB via Moneyhouse API / Gesellschaftsmonitoring COVID-19 STAT'))+
  theme_bw()+
  theme(
        legend.title = element_blank())



gg_cant_cum <- ggplotly(p_cant_cum, tooltip="text", height =  1000 ) %>%  
  plotly::config(displayModeBar = F)%>%
   layout(
          margin = list(l = 75,b=75))

gg_cant_cum <- plotly_build(gg_cant_cum)

gg_cant_cum
```

## Rollende Mittelwerte
Die Grafik ermöglicht einen Vergleich der Entwicklungen in den Kantonen in den Jahren 2019 und 2020. Dargestellt sind standardisierten rollenden Mittelwerte über die letzten fünf Werktage.  

```{r Plot Kantone,echo = F,collapse=TRUE, warning=FALSE,  message=FALSE}
pldf_cant <- dba%>%
  mutate(year = substring(date,1,4))%>%
  mutate(week = lubridate::isoweek(date))%>%
  group_by(location)%>%
  mutate(rollmean = round(rolling_mean_5(value),2))%>%
  filter(year>= 2019) %>%
  mutate(sd_value = sd(value))%>%
  mutate(mean_value = mean(value))%>%
  mutate(zvalue = (value - mean_value)/sd_value)%>%
  mutate(rollmean_zvalue = round(rolling_mean_5(zvalue),2))%>%
  ungroup()%>%
  mutate(year = substring(date,1,4))%>%
  mutate(week = lubridate::isoweek(date))%>%
  mutate(day_date = format(date, format="%m-%d"))%>%
  mutate(day_date = as.Date(day_date,format="%m-%d"))%>%
  mutate(monday = lastmon(date))


p_cant <- ggplot(pldf_cant,aes(day_date,rollmean_zvalue)) +
geom_path(aes(col=year, group=year,
              text=sprintf("Tag: %s<br>5-Tage-Mittelwert: %s<br>Standardisierter Mittelwert: %s<br>Tageswert: %s", day_date,rollmean,rollmean_zvalue,value)))+
  scale_color_manual(values = c('2019'='#EDDD79',
                                    '2020'='#F3A5A7')) +
  scale_x_date(labels = date_format("%d.%m"), breaks = as.Date(c('01.03','01.06','01.09','01.12'),format="%d.%m"))+
  facet_wrap(~ location,ncol=3)+
 labs(y = 'Standardisierter Rollender Mittelwert<br> ', 
     x = ' <br>Datum', 
     title = "", 
     subtitle = "",
     caption = paste0('Daten: SHAB via Moneyhouse API / Gesellschaftsmonitoring COVID-19 STAT'))+
  theme_bw()+
  theme(
        legend.title = element_blank())



gg_cant <- ggplotly(p_cant, tooltip="text", height =  2000 ) %>%  
  plotly::config(displayModeBar = F)%>%
   layout(
          margin = list(l = 75,b=75))

gg <- plotly_build(gg_cant)

gg_cant
```

# Methodisches & Daten
<span style="color: red;">Diese Seite dient Testzwecken. Die Angaben sind nicht überprüft.</span>

Die Angaben basieren auf einer Auswertung der im Schweizerischen Handelsamtsblatt (SHAB) publizierten Meldungen. Abgerufen werden die Meldungen via API, die von der Moneyhouse AG betrieben wird. Die Publikation im SHAB erfolgt im Normalfall mehrere Tage nach der Publikation in den kantonalen Handelsregistern. Das Datum bezieht sich auf die Publikation im SHAB.

Erfasst wird die Anzahl erstmaliger Konkursverfahrenseröffnungen gegen Firmen. Verfahrenseröffnungen aufgrund organisatorischer Mängel einer Firma (Art. 731b OR) werden nicht erfasst, weil diese nicht per se mit Zahlungsschwierigkeiten in Zusammenhang stehen. Weil es keinen national gültigen Standard gibt, wie Meldungen zu Konkursverfahrenseröffnungen zu verfassen und kategorisieren sind, wird für die Identifizierung der relevanten Meldungen ein maschinelles, mehrstufiges Filterverfahren eingesetzt, das unter anderem auch auf einer Stichwortsuche basiert. Aufgrund der Unterschiede bei der Datenerhebung kann es zu Abweichungen mit anderen Auswertungen kommen. Fehler bei der Erfassung können ebenfalls nicht ausgeschlossen werden. Der Vorteil dieser Erhebung liegt darin, dass die Daten fast in Echtzeit analysiert werden können. 

Es wird jeweils nur die erste Eröffnung eines Konkursverfahrens seit 2015 (Konkurs oder organisatorischer Mangel) gegen eine Firma erfasst. Dies ist dem Erhebungsverfahren geschuldet.

Datenquelle: SHAB via Moneyhous API.<br>
Github-Repo: [Link](https://github.com/statistikZH/economy_SHAB)<br>
Kontakt: Basil Schläpfer, Statistisches Amt Kanton Zürich,+41 43 259 75 39, basil.schlaepfer@statistik.ji.zh.ch<br><br>